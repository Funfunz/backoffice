{"version":3,"sources":["components/Field/Wrapper/style.module.scss","components/Field/Toggle/style.module.scss","hooks/useEntity.ts","services/entry.ts","components/Field/Wrapper/index.tsx","components/Field/Datetime/index.tsx","components/Field/Input/index.tsx","components/Field/Select/index.tsx","components/Field/File/RenderFile.tsx","components/Field/File/index.tsx","components/Field/RelationSelect/index.tsx","components/Field/Toggle/index.tsx","utils/fields.ts","components/Field/Input/style.module.scss","components/Field/File/style.module.scss","services/entries.ts","hooks/useEntries.ts","services/entity.ts","utils/index.ts"],"names":["module","exports","useEntity","entityName","useForceUpdate","useEffect","Entity","getEntity","isLoading","isError","shouldFetchEntity","fetchEntity","then","runForceUpdate","undefined","getEntryData","entity","filter","a","Promise","all","getMnRelations","map","relationEntities","fields","getProperties","getName","payload","resolve","query","operation","length","Object","keys","args","forEach","key","_eq","graphql","data","entry","getPk","saveEntryData","mutation","toUpperCase","substr","reduce","res","Array","isArray","filterMatch","result","entryEquals","entryDiff","newEntry","tmp","i","Math","max","FieldWrapper","name","label","children","className","classes","fieldContainer","htmlFor","field","memo","DatetimeField","type","value","onChange","readOnly","dateFormat","timeFormat","placeholder","handleChange","useCallback","Date","toISOString","substring","open","inputProps","classNames","input","InputField","event","target","Number","id","SelectField","options","onSearch","isMulti","selected","s","handleSearch","newValue","actionMeta","onInputChange","o","includes","find","isDisabled","RenderFile","url","fileType","split","pop","toLowerCase","getFileTypeFromUrl","style","renderImage","alt","src","FileField","files","RelationSelectField","props","useState","search","setSearch","relationEntityName","entries","useEntries","view","pk","labelKey","getPropertyToBeUsedAsLabel","selectedEntries","_in","mergedEntries","item","index","array","findIndex","arrayItem","Select","checked","handleToggle","toggleField","onClick","toggleIndicator","mapFieldComponents","propertyName","getPropertyLabel","isPropertyReadOnly","getPropertyEditFieldType","getPropertyRelationType","getPropertyModelType","getPropertyEditField","Component","ToggleField","relationType","getPropertyRelationEntityName","parseFilter","_like","exp","startsWith","countEntries","getEntries","take","skip","request","setEntries","total","setTotal","loading","setLoading","error","setError","oldArgs","setNewArgs","fetchEntries","catch","deleteEntry","deleteEntries","hasNewArgs","this","properties","p","isPk","backoffice","visible","relation","detail","entityPage","relations","remoteEntity","getPropertyByName","property","foreignKey","getPropertyRelation","editField","letter","friendlyName","errors","entities","config","Error"],"mappings":"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","file":"static/js/1.bb383130.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"fieldContainer\":\"style_fieldContainer__kOYHM\",\"label\":\"style_label__1Gb-6\",\"field\":\"style_field__2HVUU\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"toggleField\":\"style_toggleField__2lQQh\",\"toggleIndicator\":\"style_toggleIndicator__3-TNJ\"};","import { useEffect } from 'react'\nimport { runForceUpdate, useForceUpdate } from 'react-forceupdate'\nimport Entity from '../services/entity'\n\nfunction shouldFetchEntity(entityName?: string) {\n  return entityName &&\n    !Entity.getEntity(entityName) && \n    !Entity.isLoading(entityName) && \n    !Entity.isError(entityName)\n}\n\n/* Get entity config by entity name */\nexport function useEntity(entityName?: string): Entity | undefined {\n\n  useForceUpdate(`entities/${entityName}`)\n\n  useEffect(() => { \n    if (shouldFetchEntity(entityName)) {\n      Entity.fetchEntity(entityName as string).then(() => {\n        runForceUpdate(`entities/${entityName}`)\n      })\n    } \n  }, [entityName])\n\n  return entityName ? Entity.getEntity(entityName) : undefined\n}","import Entity from './entity'\nimport graphql, { IGQuery } from './graphql'\n\nexport interface IFilter {\n  [key: string]: string | number | boolean | IFilter\n}\nexport interface IEntryData {\n  [key: string]: string | number | boolean | undefined\n}\n\nexport async function getEntryData(entity: Entity, filter?: IFilter): Promise<IEntryData> {\n  const relationEntities = await Promise.all(entity.getMnRelations().map((entityName) => {\n    return Entity.fetchEntity(entityName)\n  }))\n  const fields = [\n    ...entity.getProperties('edit'), \n    ...relationEntities.map((entity) => ({\n      [entity.getName()]: entity.getProperties('relation') as string[],\n    })),\n  ]\n  if (!filter) {\n    const payload = {}\n    return Promise.resolve(payload)\n  }\n  const query: IGQuery = {\n    operation: entity.getName(),\n    fields: fields.length ? fields : Object.keys(filter),\n    args: {\n      filter: {},\n    },\n  }\n  Object.keys(filter).forEach((key) => {\n    (query.args as any).filter[key] = {\n      _eq: filter[key],\n    }\n  })\n  return graphql.query(query).then((data: any) => {\n    if (data) {\n      return data && data[0]\n    }\n  }).then((data) => {\n    relationEntities.forEach((entity) => {\n      data[entity.getName()] = data[entity.getName()].map((entry: Record<string, number | string>) => {\n        return entry[entity.getPk()]\n      })\n    })\n    return data\n  })\n}\n\nexport async function saveEntryData(entity: Entity, data: any, filter?: IFilter): Promise<void> {\n  if (!data || !Object.keys(data).length) {\n    return Promise.resolve()\n  }\n  const entityName = entity.getName()\n  const relationEntities = await Promise.all(entity.getMnRelations().map((entityName) => {\n    return Entity.fetchEntity(entityName)\n  }))\n  const fields = [\n    ...entity.getProperties('edit'), \n    ...relationEntities.map((entity) => ({\n      [entity.getName()]: entity.getProperties('relation') as string[],\n    })),\n  ]\n  const mutation: IGQuery = {\n    operation: entityName[0].toUpperCase() + entityName.substr(1),\n    args: {\n      data,\n    },\n    fields,\n  }\n  \n  if (filter && mutation.args) {\n    mutation.operation = 'update' + mutation.operation\n    mutation.args.filter = Object.keys(filter).reduce((res, key) => ({\n      ...res,\n      [key]: {\n        _eq: filter[key],\n      },\n    }), {})\n    if (mutation.fields?.length) {\n      mutation.fields = Object.keys(filter)\n    }\n  } else {\n    mutation.operation = 'add' + mutation.operation\n  }\n  return graphql.mutation(mutation).then(\n    (data) => {\n      const payload = Array.isArray(data)\n        ? data[0]\n        : data\n      return payload\n    },\n  )\n}\n\nexport function filterMatch(entry: any, filter?: IFilter) {\n  if (entry === undefined && filter === undefined) {\n    return true\n  }\n  if (!filter && entry && !Object.keys(entry).length) {\n    return true\n  }\n  return entry && filter && Object.keys(filter).reduce(\n    (result, key) => {\n      // eslint-disable-next-line eqeqeq\n      return result && entry[key] == filter[key]\n    },\n    true as boolean,\n  )\n}\n\nexport function entryEquals(entry: any, filter?: IFilter): boolean {\n  if (entry === undefined && filter === undefined) {\n    return true\n  }\n  if (!filter && entry && !Object.keys(entry).length) {\n    return true\n  }\n  return entry && !!filter && Object.keys({ ...filter, ...entry }).reduce(\n    (result, key) => {\n      if (typeof entry[key] === 'object' && typeof filter[key] === 'object') {\n        return result && entryEquals(entry[key], filter[key] as { [key: string]: IFilter })\n      } else {\n        // eslint-disable-next-line eqeqeq\n        return result && entry[key] == filter[key]\n      }\n    },\n    true as boolean,\n  )\n}\n\nexport function entryDiff(entry: any, newEntry: any) {\n  if (/*entry instanceof File || newEntry instanceof File || */typeof newEntry === 'string' || typeof entry === 'number' || typeof newEntry === 'number' || typeof entry === 'boolean' || typeof newEntry === 'boolean') {\n    return entry !== newEntry ? newEntry : undefined\n  }\n  if (Array.isArray(entry) || Array.isArray(newEntry)) {\n    for (let i=0; i<Math.max(entry?.length || 0, newEntry?.length || 0); i++) {\n      if (entry?.[i] !== newEntry?.[i]) {\n        return newEntry\n      }\n    }\n    return undefined\n  }\n  const result: IEntryData = {}\n  Object.keys({ ...entry, ...newEntry }).forEach((key) => {\n    const tmp = entryDiff(entry[key], newEntry[key])\n    if (tmp !== undefined) {\n      result[key] = tmp\n    }\n  })\n  return result\n}\n","import React  from \"react\"\nimport { FC, memo } from \"react\"\n\nimport classes from './style.module.scss'\n\nexport interface IFieldWrapper {\n  name: string\n  label?: string\n  children: React.ReactNode\n}\n\nconst FieldWrapper: FC<IFieldWrapper> = ({ name, label, children }) => {\n  return (\n    <div className={classes.fieldContainer}>\n      {label && (\n        <label htmlFor={`field-${name}`} className={classes.label}>\n          {label}\n        </label>\n      )}\n      <div className={classes.field}>\n        {children}\n      </div>\n    </div>\n    \n  )\n}\n\nexport default memo(FieldWrapper)\n","import React, { useCallback, FC, memo } from 'react'\nimport classNames from 'classnames'\nimport Datetime from 'react-datetime'\nimport 'react-datetime/css/react-datetime.css'\nimport './style.scss'\n\nimport classes from '../Input/style.module.scss'\n\nimport type { IFieldProps } from '../'\nimport FieldWrapper from '../Wrapper'\n\nexport interface IDatetimeField extends IFieldProps {}\n\nconst DatetimeField: FC<IDatetimeField> = ({ \n  name,\n  type = 'datetime',\n  label,\n  value,\n  onChange,\n  readOnly = false,\n  dateFormat = type === 'time' ? false : 'YYYY/MM/DD',\n  timeFormat = type === 'date' ? false : 'HH:mm',\n  placeholder = `${dateFormat || ''} ${timeFormat || ''}`,\n}) => {\n\n  const handleChange = useCallback((value) => {\n    if (onChange) {\n      try {\n        // TODO: update sql data connector\n        //value = new Date(value).toISOString().substring(0,10)\n        value = new Date(value).toISOString().substring(0,10)\n      } catch {\n      }\n      onChange(name, value)\n    }\n  }, [onChange, name])\n  \n  return (\n    <FieldWrapper name={name} label={label}>\n      <Datetime\n        value={new Date(value)}\n        onChange={handleChange}\n        dateFormat={dateFormat}\n        timeFormat={timeFormat}\n        open={readOnly === true ? false : undefined}\n        inputProps={{ \n          className: classNames({ \n            [classes.input]: true,\n            [classes.readOnly]: readOnly,\n          }),\n          placeholder,\n          readOnly: readOnly as boolean,\n        }} \n      />\n    </FieldWrapper>\n  )\n}\n\nexport default memo(DatetimeField)","import React, { useCallback, FC, memo } from \"react\"\nimport classNames from 'classnames'\nimport { IFieldProps } from \"components/Field\"\nimport FieldWrapper from 'components/Field/Wrapper'\nimport classes from './style.module.scss'\n\nexport interface IInputField extends IFieldProps {}\n\nconst InputField: FC<IInputField> = ({ \n  name,\n  type = 'text',\n  label,\n  value,\n  placeholder,\n  onChange,\n  readOnly = false\n}) => {\n\n  const handleChange = useCallback((event: React.ChangeEvent<HTMLInputElement>) => {\n    if (onChange) {\n      let value: string | number | undefined = event.target.value\n      value = (value !== undefined && value !== \"\")\n        ? type === 'number'\n          ? Number(value)\n          : value\n        : undefined\n      onChange(name, value)\n    }\n  }, [name, onChange, type])\n\n  return (\n    <FieldWrapper name={name} label={label}>\n      <input\n        className={classNames({ \n          [classes.input]: true,\n          [classes.readOnly]: readOnly,\n        })}\n        id={`field-${name}`}\n        readOnly={readOnly}\n        name={name}\n        type={type}\n        value={value}\n        placeholder={placeholder}\n        onChange={handleChange}\n      />\n    </FieldWrapper>\n    \n    \n  )\n}\n\nexport default memo(InputField)","import React, { useCallback, FC, memo } from 'react'\nimport Select, { InputActionMeta } from 'react-select'\n\nimport { IFieldProps } from 'components/Field'\nimport FieldWrapper from 'components/Field/Wrapper'\n\nexport interface ISelectFieldOption {\n  value: string | number\n  label: string | number\n}\n  \nexport interface ISelectField extends IFieldProps {\n  options?: ISelectFieldOption[]\n  isMulti?: boolean\n  onSearch?: (value: string) => void\n}\n\nconst SelectField: FC<ISelectField> = ({ \n  name,\n  label,\n  placeholder,\n  value,\n  onChange,\n  options = [],\n  readOnly,\n  onSearch,\n  isMulti = false\n}) => {\n\n  const handleChange = useCallback((selected: ISelectFieldOption | ISelectFieldOption[]) => {\n    if (onChange) {\n      const value = typeof options[0]?.value === 'number' \n        ? Array.isArray(selected) ? selected.map(s => Number(s.value)) : selected && Number(selected.value)\n        : Array.isArray(selected) ? selected.map(s => s.value) : selected?.value\n      onChange(name, (value === null && isMulti) ? [] : value)\n    }\n  }, [name, onChange, options, isMulti])\n\n  const handleSearch = useCallback((newValue: string, actionMeta: InputActionMeta) => {\n    if (onSearch) {\n      onSearch(newValue)\n    }\n  }, [onSearch])\n\n  return (\n    <FieldWrapper name={name} label={label}>\n      <Select\n        onInputChange={handleSearch}\n        onChange={handleChange as any}\n        placeholder={placeholder}\n        name={name}\n        isMulti={isMulti}\n        value={isMulti \n          ? options.filter(o => value.includes(o.value))\n          : options.find(o => o.value === value)\n        }\n        isDisabled={readOnly}\n        options={options.map((o) => ({ \n          label: o.label || o.value,\n          value: o.value,\n        }))} \n      />\n    </FieldWrapper>\n  )\n}\n\nexport default memo(SelectField)","import React, { FC, memo } from 'react'\n\nimport style from './style.module.scss'\n\nexport interface IRenderFileProps {\n  url?: string\n  fileType?: 'image'\n}\n\nfunction getFileTypeFromUrl(url: string) {\n  switch(url.split('.').pop()?.toLowerCase()) {\n    case 'jpg':\n    case 'jpeg':\n    case 'png':\n    case 'gif':\n      return 'image'\n  }\n}\n\nconst RenderFile: FC<IRenderFileProps> = ({ url = '', fileType }) => {\n\n  switch(fileType || getFileTypeFromUrl(url)) {\n    case 'image':\n      return <img className={style.renderImage} alt=\"preview\" src={url} />\n    default:\n      return <div>{url}</div>\n  }\n}\n\nexport default memo(RenderFile)","import React, { useCallback, FC, memo } from \"react\"\nimport classNames from 'classnames'\nimport { IFieldProps } from \"components/Field\"\nimport FieldWrapper from 'components/Field/Wrapper'\nimport classes from './style.module.scss'\nimport RenderFile from \"./RenderFile\"\n\nexport interface IFileField extends IFieldProps {}\n\nconst FileField: FC<IFileField> = ({ \n  name,\n  label,\n  placeholder,\n  value,\n  onChange,\n  readOnly = false,\n}) => {\n\n  const handleChange = useCallback((event: React.ChangeEvent<HTMLInputElement>) => {\n    if (onChange) {\n      onChange(name, event.target?.files?.[0])\n    }\n  }, [name, onChange])\n\n  return (\n    <FieldWrapper name={name} label={label}>\n      {readOnly\n        ? <RenderFile url={value} />\n        : <input\n            className={classNames({ \n              [classes.input]: true,\n              [classes.readOnly]: readOnly,\n            })}\n            id={`field-${name}`}\n            name={name}\n            type=\"file\"\n            placeholder={placeholder}\n            onChange={handleChange}\n          />\n      }\n      \n    </FieldWrapper>\n  )\n}\n\nexport default memo(FileField)","import React, { FC, memo, useCallback, useState } from \"react\"\nimport { useEntity } from \"hooks/useEntity\"\nimport { useEntries } from \"hooks/useEntries\"\nimport Select, { ISelectField, ISelectFieldOption } from \"components/Field/Select\"\n\nexport interface IRelationSelectField extends ISelectField {\n  relationEntityName?: string\n}\n\nconst RelationSelectField: FC<IRelationSelectField> = (props) => {\n  const isMulti = props.type === 'm:n' || props.type === 'n:m'\n\n  const [search, setSearch] = useState<string>()\n  const handleSearch = useCallback((newValue: string) => {\n    setSearch(newValue)\n  }, [])\n  \n  const entity = useEntity(props.relationEntityName)\n  const { entries } = useEntries({ entity, view: 'relation', search })\n\n  const pk = entity?.getPk() || 'id'\n  const labelKey = entity?.getPropertyToBeUsedAsLabel() || 'name'\n\n  const { entries: selectedEntries } = useEntries({ \n    entity,\n    view: 'relation',\n    filter: props.value && {\n      [pk]: isMulti ? { _in: props.value } : props.value\n    }\n  })\n  \n  const mergedEntries = [\n    ...entries,\n    ...selectedEntries,\n  ].filter((item, index, array) => {\n    return item[pk] && index === array.findIndex((arrayItem) => {\n      return arrayItem[pk] === item[pk]\n    })\n  })\n\n  return (\n    <Select\n      onSearch={handleSearch}\n      isMulti={isMulti}\n      options={mergedEntries.map((entry) => {\n        return {\n          label: entry[labelKey],\n          value: entry[pk],\n        } as ISelectFieldOption\n      })}\n      {...props} \n    /> \n  )\n}\n\nexport default memo(RelationSelectField)","import React, { useCallback, FC, memo } from 'react'\n\nimport { IFieldProps } from 'components/Field'\nimport FieldWrapper from 'components/Field/Wrapper'\n\nimport style from './style.module.scss'\n\nexport interface ISelectFieldOption {\n  value: string | number\n  label: string | number\n}\n  \nexport interface IToggleField extends IFieldProps {\n  options?: ISelectFieldOption[]\n  isMulti?: boolean\n}\n\nconst SelectField: FC<IToggleField> = ({ \n  name,\n  label,\n  value,\n  onChange,\n  readOnly,\n}) => {\n\n  const handleChange = useCallback((event: React.ChangeEvent<HTMLInputElement>) => {\n    if (onChange) {\n      const value = event.target.checked\n      onChange(name, value)\n    }\n  }, [name, onChange])\n\n  const handleToggle = useCallback(() => {\n    if (onChange) {\n      onChange(name, !value)\n    }\n  }, [onChange, value, name])\n\n  return (\n    <FieldWrapper name={name} label={label}>\n      <div className={style.toggleField} onClick={handleToggle}>\n        <input \n          type=\"checkbox\"\n          id={`field-${name}`}\n          name={name}\n          onChange={handleChange}\n          checked={!!value}\n        />\n        <div className={style.toggleIndicator}></div>\n      </div>\n    </FieldWrapper>\n  )\n}\n\nexport default memo(SelectField)","import Entity from 'services/entity'\nimport { \n  IFieldProps,\n  InputField,\n  SelectField,\n  FieldTypes,\n  RelationSelectField,\n  FileField,\n  DatetimeField,\n  ToggleField,\n} from 'components/Field'\n\nexport interface IMappedField {\n  Component: React.ComponentType<IFieldProps>\n  props: IFieldProps\n}\n\nexport function mapFieldComponents(entity?: Entity, view: 'new' | 'edit' | 'view' | 'filter' = 'view'): IMappedField[] {\n  return entity ? [\n    ...entity.getProperties(view),\n    ...entity.getMnRelations(),\n  ].map(\n    (propertyName: string) => {\n\n      const props: IFieldProps = {\n        name: propertyName,\n        label: entity.getPropertyLabel(propertyName),\n        readOnly: entity.isPropertyReadOnly(propertyName),\n        type: (\n          entity.getPropertyEditFieldType(propertyName) || \n          entity.getPropertyRelationType(propertyName) || \n          entity.getPropertyModelType(propertyName) ||\n          'text'\n        ) as FieldTypes,\n        ...(entity.getPropertyEditField(propertyName)),\n      }\n\n      switch (props.type) {\n        case 'boolean':\n        case 'toggle':\n          return {\n            Component: ToggleField,\n            props,\n          }\n        case 'n:1':\n        case 'n:m':\n        case 'm:n':\n          return {\n            Component: RelationSelectField,\n            props: {\n              relationType: props.type,\n              relationEntityName: entity.getPropertyRelationEntityName(propertyName),\n              ...props, \n            }\n          }\n        case 'select':\n          return {\n            Component: SelectField,\n            props,\n          }\n        case 'file':\n          return {\n            Component: FileField,\n            props\n          }\n        case 'date':\n        case 'datetime':\n        case 'time':\n          return {\n            Component: DatetimeField,\n            props,\n          }\n        case 'text':\n        case 'number':\n        case 'password':\n        default:\n          return {\n            Component: InputField,\n            props,\n          }\n      }\n    }\n  ) : []\n}","// extracted by mini-css-extract-plugin\nmodule.exports = {\"input\":\"style_input__w9gXB\",\"readOnly\":\"style_readOnly__1h-3l\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"input\":\"style_input__t-6VG\",\"readOnly\":\"style_readOnly__17g9J\",\"renderImage\":\"style_renderImage__x3vv6\"};","import { IEntryData, IFilter } from './entry'\nimport Entity from './entity'\nimport graphql, { IGQuery } from './graphql'\n\nexport interface IGetEntriesArgs {\n  entity: Entity\n  filter?: IFilter\n  view?: Parameters<Entity['getProperties']>[0]\n  take?: number\n  skip?: number\n  search?: string\n}\n\nexport function parseFilter(entity: Entity, filter: IFilter, search?: string) {\n  const result: any = {}\n  Object.keys(filter).filter((key) => filter[key]).forEach((key) => {\n    const value = filter[key]\n    result[key] = typeof value === 'string'\n      ? { _like: `%${value}%` }\n      : (typeof value === 'object' && Object.keys(value).find(exp => exp.startsWith('_')))\n        ? value\n        : { _eq: value }\n  })\n  if (search) {\n    result[entity.getPropertyToBeUsedAsLabel()] = {\n      _like: `%${search}%`\n    }\n  }\n  return result\n}\n\nexport function countEntries({ entity, filter = {} }: IGetEntriesArgs): Promise<number> {\n\n  const query: IGQuery = {\n    operation: entity.getName() + 'Count',\n    args: {\n      filter: parseFilter(entity, filter),\n    },\n  }\n  return graphql.query(query).then((data: any) => {\n    if (data) {\n      return data\n    }\n  })\n}\n\nexport function deleteEntries(entity: Entity, filter: IFilter) {\n  const entityName = entity.getName()\n\n  const query = {\n    operation: `delete${entityName[0].toUpperCase() + entityName.substr(1)}`,\n    args: {\n      filter: parseFilter(entity, filter),\n    },\n    fields: ['deleted'],\n  }\n  return graphql.mutation(query).then((data: any) => {\n    if (data) {\n      return data\n    }\n  })\n}\n\nexport function getEntries({\n  entity,\n  filter = {},\n  view = 'list',\n  take = 10,\n  skip = 0,\n  search,\n}: IGetEntriesArgs): Promise<IEntryData[]> {\n\n  const query: IGQuery = {\n    operation: entity.getName(),\n    fields: entity.getProperties(view) || Object.keys(filter),\n    args: {\n      filter: parseFilter(entity, filter, search),\n      take,\n      skip,\n    },\n  }\n  \n  return graphql.query(query).then((data: any) => {\n    if (data) {\n      return data\n    }\n  })\n}\n","import { useCallback, useEffect, useState } from 'react'\nimport Entity from '../services/entity'\nimport { countEntries, getEntries, deleteEntries } from '../services/entries'\nimport { entryEquals, IEntryData, IFilter } from '../services/entry'\n\nexport interface IUseEntriesArgs {\n  entity?: Entity\n  filter?: IFilter\n  view?: Parameters<Entity['getProperties']>[0]\n  skip?: number\n  take?: number\n  request?: boolean\n  search?: string\n}\nexport interface IUseEntriesRet {\n  entries: IEntryData[]\n  error?: boolean\n  loading?: boolean\n  total: number\n  deleteEntry: (pk: number | string) => void\n}\n\n/* Return list of entries for one entity based on a filter */\nexport function useEntries({\n  entity,\n  filter = {},\n  view = 'list',\n  skip = 0,\n  take = 10,\n  request = true,\n  search,\n}: IUseEntriesArgs): IUseEntriesRet {\n\n  const [entries, setEntries] = useState<IEntryData[]>([])\n  const [total, setTotal] = useState(0)\n\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState(false)\n\n  const [oldArgs, setNewArgs] = useState<{ entity?: string, filter?: IFilter, skip?: number, take?: number, search?: string }>({})\n\n  const fetchEntries = useCallback(() => {\n    if (!entity || !request) return\n    setLoading(true)\n    return Promise.all([\n      getEntries({ entity, filter, skip, take, view, search }),\n      countEntries({ entity, filter }),\n    ]).then(([data, total]) => {\n      setLoading(false)\n      if (data) {\n        setEntries(data)\n        setTotal(total)\n      } else {\n        setError(true)\n      }\n    }).catch(() => {\n      setLoading(false)\n      setError(true)\n    })\n  }, [entity, filter, skip, view, take, request, search])\n\n  const deleteEntry = useCallback((pk: string | number) => {\n    if (entity) {\n      return deleteEntries(entity, {\n        [entity?.getPk() || 'id']: pk,\n      }).then(fetchEntries)\n    }\n  }, [entity, fetchEntries])\n\n  const hasNewArgs = useCallback(() => {\n    if (\n      entity?.getName() !== oldArgs.entity ||\n      !entryEquals(oldArgs.filter, filter) ||\n      skip !== oldArgs.skip ||\n      take !== oldArgs.take ||\n      search !== oldArgs.search\n    ) {\n      setNewArgs({ entity: entity?.getName(), filter: { ...filter }, skip, take, search })\n      return true\n    }\n    return false\n  }, [entity, oldArgs, filter, skip, take, search])\n\n  useEffect(() => {\n    if (hasNewArgs() && !error) {\n      fetchEntries()\n    }\n  }, [loading, error, hasNewArgs, fetchEntries])\n\n  return { entries, error, loading, total, deleteEntry }\n}","import graphql from './graphql'\nimport { friendlyName } from '../utils'\nimport { IEntity } from '../utils/funfunzTypings'\n\nexport default class Entity {\n  private static entities: Record<string, Entity> = {}\n  private static loading: Record<string, boolean> = {}\n  private static errors: Record<string, boolean> = {}\n  private entity: IEntity\n  constructor(entity: IEntity) {\n    this.entity = entity\n  }\n  getName() {\n    return this.entity.name\n  }\n  getPk() {\n    return this.entity.properties?.find(p => p.isPk)?.name || 'id'\n  }\n  getLabel() {\n    return this.entity.backoffice?.label || this.entity.name\n  }\n  \n  getProperties(view: 'view' | 'new' |'list' | 'edit' | 'relation' | 'filter' = 'list') {\n    return this.entity.properties?.filter(p => {\n      switch (view) {\n      case 'relation':\n        return p.isPk || p.backoffice?.visible?.relation !== false\n      case 'view':\n        return p.isPk || p.backoffice?.visible?.detail !== false\n      case 'new':\n      case 'edit':\n        return !this.isPropertyReadOnly(p.name) || \n          (p.backoffice?.visible?.detail !== undefined && p.backoffice?.visible?.detail) ||\n          this.getMnRelations()\n      case 'list':\n      case 'filter':\n      default:\n        return p.backoffice?.visible?.entityPage !== false\n      }\n    }).map(p => p.name) || []\n  }\n  getMnRelations() {\n    return this.entity.relations?.filter((relation) => {\n      return relation.type === 'm:n' || relation.type === 'n:m'\n    }).map((relation) => {\n      return relation.remoteEntity\n    }) || []\n  }\n  getPropertyToBeUsedAsLabel() {\n    return this.entity.properties?.find(p => p.backoffice?.visible?.relation)?.name || \n    this.getPropertyByName('name')?.name  ||\n    this.getPk()\n  }\n  private getPropertyByName(propertyName: string) {\n    return this.entity.properties?.find(p => p.name === propertyName)\n  }\n  isPropertyReadOnly(propertyName: string) {\n    const property = this.getPropertyByName(propertyName)\n    return this.getPk() === propertyName || property?.readOnly\n  }\n  getPropertyModelType(propertyName: string) {\n    const property = this.getPropertyByName(propertyName)\n    return property?.type || 'string'\n  }\n  private getPropertyRelation(propertyName: string) {\n    return this.entity.relations?.find((relation) => {\n      return relation.foreignKey === propertyName || \n        relation.remoteEntity === propertyName\n    })\n  }\n  getPropertyRelationType(propertyName: string) {\n    const relation = this.getPropertyRelation(propertyName)\n    if (this.getPk() !== propertyName) {\n      return relation?.type\n    }\n  }\n  getPropertyRelationEntityName(propertyName: string) {\n    const relation = this.getPropertyRelation(propertyName)\n    return relation?.remoteEntity\n  }\n  getPropertyEditField(propertyName: string): Record<string, string|number|boolean> {\n    const property = this.getPropertyByName(propertyName)\n    return property?.backoffice?.editField || {}\n  }\n  getPropertyEditFieldType(propertyName: string) {\n    const editField = this.getPropertyEditField(propertyName)\n    return editField.type\n  }\n  getPropertyLabel(propertyName: string) {\n    const property = this.getPropertyByName(propertyName)\n    return property?.backoffice?.label || friendlyName(property?.name || propertyName)\n  }\n  static isError(entityName: string) {\n    return Entity.errors[entityName] ? true : false\n  }\n  static isLoading(entityName: string) {\n    return Entity.loading[entityName] || false\n  }\n  static getEntity(entityName: string) {\n    return Entity.entities[entityName]\n  }\n  static async fetchEntity(entityName: string) {\n    if (Entity.entities[entityName]) {\n      return Entity.entities[entityName]\n    }\n    Entity.loading[entityName] = true\n    const config = await graphql.query({\n      operation: 'config',\n      fields: [entityName],\n    })\n    if (config[entityName]) {\n      Entity.entities[entityName] = new Entity(config[entityName])\n      Entity.loading[entityName] = false\n      Entity.errors[entityName] = false\n      return Entity.entities[entityName]\n    } else {\n      Entity.loading[entityName] = false\n      Entity.errors[entityName] = true\n      throw new Error(`Entity ${entityName} not found`)\n    }\n  }\n}\n","\nexport function delay(ms: number) {\n  return new Promise((resolve) => setTimeout(resolve, ms))\n}\n\nexport const desktopSize = 1120\n\nexport function friendlyName(name: string) {\n  let result = ''\n  for(const letter of name) {\n    if (letter.toUpperCase() === letter) {\n      result += ` ${letter}`\n    } else if (result === '') {\n      result += letter.toUpperCase()\n    } else {\n      result += letter\n    }\n  }\n  return result\n}"],"sourceRoot":""}